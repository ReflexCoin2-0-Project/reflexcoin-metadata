<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>RFX2 Community Spin</title>

<style>
/* ‚ö†Ô∏è Layout e gr√°fico mantidos. S√≥ corre√ß√µes l√≥gicas e seta */
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:radial-gradient(circle at top,#0b1220,#05080f);
  color:#fff;
}

.container{
  max-width:420px;
  margin:0 auto;
  padding:20px;
  text-align:center;
}

.wheel-wrapper{
  position:relative;
  width:320px;
  height:320px;
  margin:0 auto 10px;
}

#wheel{
  width:100%;
  height:100%;
  border-radius:50%;
  border:4px solid #f5c542;
  transition:transform 4s cubic-bezier(.17,.67,.32,1.02);
}

/* üîª SETA FIXA EM BAIXO ‚Äì APONTA PARA CIMA */
.pointer{
  position:absolute;
  bottom:-14px;
  left:50%;
  transform:translateX(-50%) rotate(180deg);
  width:0;
  height:0;
  border-left:12px solid transparent;
  border-right:12px solid transparent;
  border-bottom:22px solid #4dd0ff;
  z-index:10;
}

button{
  background:#f5c542;
  border:none;
  border-radius:20px;
  padding:12px 24px;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}

input{
  width:100%;
  padding:10px;
  border-radius:20px;
  border:none;
  margin-top:10px;
}

.result{
  margin-top:10px;
  font-size:18px;
}
</style>
</head>
<body>

<div class="container">
  <h2>RFX2 Community Spin</h2>

  <div class="wheel-wrapper">
    <div class="pointer"></div>
    <canvas id="wheel" width="320" height="320"></canvas>
  </div>

  <button id="spinBtn">Spin</button>
  <input placeholder="Solana wallet (optional)" />
  <button>Connect Phantom</button>
  <button>Share your win on X</button>
  <div class="result" id="result">Result: ‚Äî</div>
</div>

<script>
/* =========================
   üéØ L√ìGICA CORRIGIDA
   - Probabilidade igual
   - Resultado = posi√ß√£o real
   - Seta fixa / roda gira
========================= */

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

const prizes = ["üî•","‚ù§Ô∏è","‚≠ê","üíé","üôÇ","üò°"]; // igual para todos
const colors = ["#6a5acd","#6f60d5"];

const sliceAngle = (2 * Math.PI) / prizes.length;
let currentRotation = 0;

function drawWheel(){
  for(let i=0;i<prizes.length;i++){
    ctx.beginPath();
    ctx.moveTo(160,160);
    ctx.fillStyle = colors[i % 2];
    ctx.arc(160,160,160,i*sliceAngle,(i+1)*sliceAngle);
    ctx.fill();

    ctx.save();
    ctx.translate(160,160);
    ctx.rotate(i*sliceAngle + sliceAngle/2);
    ctx.textAlign="right";
    ctx.fillStyle="#fff";
    ctx.font="26px Arial";
    ctx.fillText(prizes[i],130,10);
    ctx.restore();
  }
}

drawWheel();

const spinBtn = document.getElementById("spinBtn");
const resultEl = document.getElementById("result");

spinBtn.onclick = () => {
  spinBtn.disabled = true;

  // üé≤ Sorteio justo
  const winnerIndex = Math.floor(Math.random() * prizes.length);

  // üéØ √Çngulo exato da fatia vencedora
  const targetAngle = (prizes.length - winnerIndex) * sliceAngle - sliceAngle / 2;

  // üîÑ Voltas extra para anima√ß√£o
  const spins = 6 * 2 * Math.PI;
  currentRotation = spins + targetAngle;

  canvas.style.transform = `rotate(${currentRotation}rad)`;

  setTimeout(() => {
    resultEl.textContent = `Result: ${prizes[winnerIndex]}`;
    spinBtn.disabled = false;
  }, 4200);
};
</script>

</body>
</html>
