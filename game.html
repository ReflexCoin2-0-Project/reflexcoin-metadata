<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>RFX2 Community Spin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:radial-gradient(circle at top,#0b1220,#05080f);
  color:#fff;
}
.container{
  max-width:1400px;
  margin:auto;
  padding:40px;
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:30px;
}
.card{
  background:linear-gradient(180deg,#0e1628,#0a1020);
  border-radius:20px;
  padding:30px;
}
h1{color:#f5c400;}
ul{padding-left:18px;}
.center{text-align:center;}
canvas{display:block;margin:auto;}
button{
  background:#f5c400;
  border:none;
  border-radius:30px;
  padding:12px 26px;
  font-weight:bold;
  cursor:pointer;
  margin-top:12px;
}
.logo-box{
  background:#fff;
  border-radius:20px;
  padding:30px;
  text-align:center;
}
.logo-box img{width:130px;}
.logo-box p{
  color:#c9a300;
  font-weight:bold;
  margin-top:12px;
}
input{
  width:100%;
  padding:10px;
  border-radius:20px;
  border:none;
  margin-top:10px;
}
.small{font-size:13px;opacity:.8;margin-top:8px;}
</style>
</head>

<body>

<div class="container">

<!-- LEFT -->
<div class="card">
  <h1>üé° Giro da Comunidade RFX2</h1>
  <p>Experimento conduzido pela comunidade, baseado em emo√ß√£o e participa√ß√£o.</p>
  <ul>
    <li>‚è± 1 giro a cada 6 horas</li>
    <li>üíé Fatia de airdrop inclu√≠da</li>
    <li>üéØ Probabilidade igual para todos os emojis</li>
  </ul>
</div>

<!-- CENTER -->
<div class="card center">
  <canvas id="wheel" width="320" height="320"></canvas>

  <button onclick="spin()">Rodar</button>

  <input id="wallet" placeholder="Carteira Solana (opcional)">
  <button onclick="connectPhantom()">Conectar Phantom</button>

  <button onclick="shareX()">Compartilhar vit√≥ria no X</button>

  <div class="small" id="status"></div>
</div>

<!-- RIGHT -->
<div class="logo-box">
  <img src="logo-rfx2.png">
  <p>Guarde seus airdrops.<br>Acumule. Apoie o RFX2.</p>
</div>

</div>

<script>
// -------- RODA --------
const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");
const slices=["üòä","üò°","üî•","‚ù§Ô∏è","‚≠ê","üíé"];
const center=canvas.width/2;
const radius=center-10;
const sliceAngle=(Math.PI*2)/slices.length;
let rotation=0;
let lastSpin=0;

function drawWheel(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  slices.forEach((emoji,i)=>{
    const start=rotation+i*sliceAngle;
    ctx.beginPath();
    ctx.moveTo(center,center);
    ctx.arc(center,center,radius,start,start+sliceAngle);
    ctx.fillStyle=i%2?"#6d4bd3":"#4c37a6";
    ctx.fill();
    ctx.strokeStyle="#f5c400";
    ctx.lineWidth=3;
    ctx.stroke();

    ctx.save();
    ctx.translate(center,center);
    ctx.rotate(start+sliceAngle/2);
    ctx.font="28px serif";
    ctx.textAlign="center";
    ctx.fillStyle="#fff";
    ctx.fillText(emoji,radius*0.65,10);
    ctx.restore();
  });

  // seta
  ctx.fillStyle="#4db5ff";
  ctx.beginPath();
  ctx.moveTo(center,0);
  ctx.lineTo(center-10,20);
  ctx.lineTo(center+10,20);
  ctx.fill();
}

drawWheel();

function spin(){
  const now=Date.now();
  if(now-lastSpin<6*60*60*1000){
    alert("Aguarde 6 horas para novo giro.");
    return;
  }
  lastSpin=now;

  const target=Math.floor(Math.random()*slices.length);
  let spins=8+Math.random()*4;
  let start=null;

  function animate(t){
    if(!start) start=t;
    rotation+=0.18;
    drawWheel();
    if(t-start<3000){
      requestAnimationFrame(animate);
    }else{
      const result=slices[target];
      document.getElementById("status").innerText="Resultado: "+result;
      window.lastResult=result;
    }
  }
  requestAnimationFrame(animate);
}

// -------- PHANTOM --------
async function connectPhantom(){
  if(window.solana && window.solana.isPhantom){
    try{
      const res=await window.solana.connect();
      document.getElementById("wallet").value=res.publicKey.toString();
      document.getElementById("status").innerText="Phantom conectado ‚úî";
    }catch(e){
      alert("Conex√£o cancelada");
    }
  }else{
    alert("Phantom Wallet n√£o encontrada");
  }
}

// -------- X SHARE --------
function shareX(){
  if(!window.lastResult){
    alert("Gire a roleta primeiro");
    return;
  }
  const text=`I just spun the RFX2 Community Wheel and got ${window.lastResult} üé°üíé

Join the experiment on Solana üëá
https://reflexcoin2-0-project.github.io/reflexcoin-metadata/`;

  const url="https://twitter.com/intent/tweet?text="+encodeURIComponent(text);
  window.open(url,"_blank");
}
</script>

</body>
</html>
